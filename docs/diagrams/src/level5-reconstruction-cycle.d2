direction: down

degradation: "Degradation" {
  style.fill: "#ffebee"
  style.stroke: "#f44336"
  style.border-radius: 8
  style.shadow: true

  TRIGGER: "Trigger Event\n(resource collapse |\noverload | manual)" {
    style.fill: "#ffcdd2"
    style.stroke: "#e53935"
    style.border-radius: 6
  }
  CLASSIFY: "Classify Modules\ncore | extended | optional" {
    style.fill: "#ffcdd2"
    style.stroke: "#e53935"
    style.border-radius: 6
  }
  SHED: "Shed Nonessential\noptional → disabled first\nthen extended" {
    style.fill: "#ffcdd2"
    style.stroke: "#e53935"
    style.border-radius: 6
  }
  RETAIN: "Retain Core\n≥ 85% core function" {
    style.fill: "#ffcdd2"
    style.stroke: "#e53935"
    style.border-radius: 6
  }
}

operation: "Degraded Operation" {
  style.fill: "#fff9c4"
  style.stroke: "#fbc02d"
  style.border-radius: 8
  style.shadow: true

  REDUCED: "Run at reduced capacity\nCore modules only" {
    style.fill: "#fff59d"
    style.stroke: "#f9a825"
    style.border-radius: 6
  }
  MONITOR: "Monitor for recovery\nconditions" {
    style.fill: "#fff59d"
    style.stroke: "#f9a825"
    style.border-radius: 6
  }
}

reconstruction: "Reconstruction" {
  style.fill: "#c8e6c9"
  style.stroke: "#2e7d32"
  style.border-radius: 8
  style.shadow: true

  DETECT_R: "Detect resources\nrecovering" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  PRIORITIZE: "Rebuild priority order:\n1) core → 2) extended\n→ 3) optional" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  VALIDATE: "Validate each rebuild:\naccuracy ≥ ?\nidentity drift < 0.05" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  COMPLETE: "Full operation\nrestored" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
}

HALT: "HALT\nIdentity preservation\ntakes priority" {
  style.fill: "#ffcdd2"
  style.stroke: "#e53935"
  style.stroke-width: 2
  style.border-radius: 6
}

degradation.TRIGGER -> degradation.CLASSIFY { style.animated: true }
degradation.CLASSIFY -> degradation.SHED { style.animated: true }
degradation.SHED -> degradation.RETAIN { style.animated: true }
degradation.RETAIN -> operation.REDUCED { style.animated: true }
operation.REDUCED -> operation.MONITOR { style.animated: true }
operation.MONITOR -> reconstruction.DETECT_R: "resources returning" { style.animated: true }
reconstruction.DETECT_R -> reconstruction.PRIORITIZE { style.animated: true }
reconstruction.PRIORITIZE -> reconstruction.VALIDATE { style.animated: true }
reconstruction.VALIDATE -> reconstruction.COMPLETE { style.animated: true }
reconstruction.VALIDATE -> HALT: "identity drift!" { style.stroke-dash: 5 }
