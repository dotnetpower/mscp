DomainA: "Domain A (Known)" {
  style: {
    fill: "#e3f2fd"
    stroke: "#1976d2"
    border-radius: 8
    shadow: true
  }

  SA: "Skill Acquired\nin Domain A" {
    style: {
      fill: "#bbdefb"
      stroke: "#1976d2"
      border-radius: 6
    }
  }

  CS: "Context Signature\nextracted" {
    style: {
      fill: "#bbdefb"
      stroke: "#1976d2"
      border-radius: 6
    }
  }

  SA -> CS { style.animated: true }
}

Matcher: "Context Signature Matcher" {
  style: {
    fill: "#fff9c4"
    stroke: "#f9a825"
    border-radius: 8
    shadow: true
  }

  VEC: "Vector Similarity\n(cosine)" {
    style: {
      fill: "#fff59d"
      stroke: "#f9a825"
      border-radius: 6
    }
  }

  SEM: "Semantic Bridge\n(LLM-based)" {
    style: {
      fill: "#fff59d"
      stroke: "#f9a825"
      border-radius: 6
    }
  }

  SCORE: "Combined Score\n= w1*sim_sig + w2*sim_dom\n+ w3*sim_temporal" {
    style: {
      fill: "#fff59d"
      stroke: "#f9a825"
      border-radius: 6
    }
  }

  VEC -> SCORE { style.animated: true }
  SEM -> SCORE { style.animated: true }
}

DomainB: "Domain B (Novel)" {
  style: {
    fill: "#e8f5e9"
    stroke: "#388e3c"
    border-radius: 8
    shadow: true
  }

  ENTRY: "Domain B entry" {
    style: {
      fill: "#c8e6c9"
      stroke: "#388e3c"
      border-radius: 6
    }
  }

  CAND: "Candidate Skills\n(top-k, k=5)" {
    style: {
      fill: "#c8e6c9"
      stroke: "#388e3c"
      border-radius: 6
    }
  }

  ADAPT: "Adaptation\nExperiment" {
    style: {
      fill: "#c8e6c9"
      stroke: "#388e3c"
      border-radius: 6
    }
  }

  VAL: "Validation\nSuccess?" {
    shape: diamond
    style: {
      fill: "#c8e6c9"
      stroke: "#388e3c"
      border-radius: 6
    }
  }

  CAND -> ADAPT -> VAL { style.animated: true }
}

Outcome: "Outcome" {
  style: {
    fill: "#f5f5f5"
    stroke: "#9e9e9e"
    border-radius: 8
    shadow: true
  }

  SUCCESS: "Transfer Success\ngeneralization_score up" {
    style: {
      fill: "#c8e6c9"
      stroke: "#2e7d32"
      border-radius: 6
    }
  }

  FAIL: "Transfer Failed\n-> Learn new skill" {
    style: {
      fill: "#ffcdd2"
      stroke: "#c62828"
      border-radius: 6
    }
  }
}

DomainA.CS -> Matcher: {
  style.animated: true
}

DomainB.ENTRY -> Matcher: {
  style.animated: true
}

Matcher -> DomainB.CAND: {
  style.animated: true
}

DomainB.VAL -> Outcome.SUCCESS: "yes" {
  style.animated: true
  style.stroke: "#2e7d32"
}

DomainB.VAL -> Outcome.FAIL: "no" {
  style.animated: true
  style.stroke: "#c62828"
}
