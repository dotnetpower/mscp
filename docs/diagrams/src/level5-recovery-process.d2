direction: down

recovery: "Existential Recovery" {
  style.fill: "#e3f2fd"
  style.stroke: "#2196f3"
  style.stroke-width: 2
  style.border-radius: 8
  style.shadow: true

  DETECT: "Detect Scenario\nClassify threat type" {
    style.fill: "#bbdefb"
    style.stroke: "#1976d2"
    style.border-radius: 6
  }
  MVC: "Compute MVC\nMinimum Viable Cognition\n(baseline: 0.30)" {
    style.fill: "#bbdefb"
    style.stroke: "#1976d2"
    style.border-radius: 6
  }
  DISABLE: "Disable Non-Essential\nPreserve core 8 modules" {
    style.fill: "#bbdefb"
    style.stroke: "#1976d2"
    style.border-radius: 6
  }
  SURVIVE: "Survive Phase\nOperate at reduced capacity" {
    style.fill: "#bbdefb"
    style.stroke: "#1976d2"
    style.border-radius: 6
  }
  REBUILD: "Rebuild Phase\nRe-enable modules\nin priority order" {
    style.fill: "#bbdefb"
    style.stroke: "#1976d2"
    style.border-radius: 6
  }
}

core_modules: "Always-Preserved Modules" {
  style.fill: "#c8e6c9"
  style.stroke: "#2e7d32"
  style.border-radius: 8
  style.shadow: true

  CM1: "identity_stabilizer" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  CM2: "state_vector" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  CM3: "prediction_engine" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  CM4: "meta_comparator" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  CM5: "stability_controller" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  CM6: "ethical_kernel" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  CM7: "self_preservation_damper" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
  CM8: "existential_guard" {
    style.fill: "#e8f5e9"
    style.stroke: "#388e3c"
    style.border-radius: 6
  }
}

recovery.DETECT -> recovery.MVC { style.animated: true }
recovery.MVC -> recovery.DISABLE { style.animated: true }
recovery.DISABLE -> recovery.SURVIVE { style.animated: true }
recovery.SURVIVE -> recovery.REBUILD { style.animated: true }
recovery.DISABLE -> core_modules { style.stroke-dash: 5 }
