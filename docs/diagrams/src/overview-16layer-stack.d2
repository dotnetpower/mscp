direction: down

title: "16-Layer Cognitive Stack" {
  style: {
    font-size: 20
    bold: true
    underline: false
  }
}

stack: "16-Layer Cognitive Stack" {
  style: {
    fill: "#fafafa"
    stroke: "#424242"
    border-radius: 8
    shadow: true
    font-size: 16
    bold: true
  }

  L01: "L1: Perception — Intent, Emotion, Sensor Encoding" {
    style: { fill: "#c8e6c9"; stroke: "#388e3c"; border-radius: 6; font-size: 14 }
  }

  L02: "L2: World Model — Knowledge Graph, Entity Tracking" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6; font-size: 14 }
  }

  L03: "L3: Self Model ★ — Identity Vector, Capability Model" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6; font-size: 14; bold: true }
  }

  L035: "L3.5: Belief Graph — Belief Nodes + Consistency Tensor" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6; font-size: 14 }
  }

  L04: "L4: Prediction Engine — External + Internal Predictions" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6; font-size: 14 }
  }

  L05: "L5: Goal Generator — Identity-Derived Goal Hierarchy" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6; font-size: 14 }
  }

  L055: "L5.5: Ethical Kernel — Layer 0 (Immutable) + Layer 1" {
    style: { fill: "#ffcdd2"; stroke: "#e53935"; border-radius: 6; font-size: 14; bold: true }
  }

  L06: "L6: Action Planner — Execution + Strategy Evaluation" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6; font-size: 14 }
  }

  L07: "L7: Cognitive Engine — LLM Backends (Primary + Meta)" {
    style: { fill: "#ffe0b2"; stroke: "#ef6c00"; border-radius: 6; font-size: 14 }
  }

  L08: "L8: Meta Comparator — Prediction vs Actual + Self-Impact" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6; font-size: 14 }
  }

  L09: "L9: Self-Update Loop — Delta-Clamped Structured Updates" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6; font-size: 14 }
  }

  L10: "L10: Escalation Guard — Recursion Safety + Rollback" {
    style: { fill: "#ffcdd2"; stroke: "#e53935"; border-radius: 6; font-size: 14 }
  }

  L11: "L11: Depth Controller — Meta-Cognitive Depth 1 & 2" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6; font-size: 14 }
  }

  L12: "L12: Stability Control — Lyapunov Convergence Guarantee" {
    style: { fill: "#ffcdd2"; stroke: "#e53935"; border-radius: 6; font-size: 14 }
  }

  L13: "L13: Budget Controller — Cognitive Resource Management" {
    style: { fill: "#e0e0e0"; stroke: "#616161"; border-radius: 6; font-size: 14 }
  }

  L14: "L14: Global Workspace — Unified Cognitive State Broadcast" {
    style: { fill: "#e0e0e0"; stroke: "#616161"; border-radius: 6; font-size: 14 }
  }

  L15: "L15: Affective Engine — Internal Emotion + Motivation" {
    style: { fill: "#e1bee7"; stroke: "#8e24aa"; border-radius: 6; font-size: 14 }
  }

  L16: "L16: Survival Instinct — Homeostatic Monitoring + Defense" {
    style: { fill: "#ffcdd2"; stroke: "#e53935"; border-radius: 6; font-size: 14 }
  }

  # Sequential layer ordering
  L01 -> L02: { style.animated: true; style.stroke: "#9e9e9e" }
  L02 -> L03: { style.animated: true; style.stroke: "#9e9e9e" }
  L03 -> L035: { style.animated: true; style.stroke: "#9e9e9e" }
  L035 -> L04: { style.animated: true; style.stroke: "#9e9e9e" }
  L04 -> L05: { style.animated: true; style.stroke: "#9e9e9e" }
  L05 -> L055: { style.animated: true; style.stroke: "#9e9e9e" }
  L055 -> L06: { style.animated: true; style.stroke: "#9e9e9e" }
  L06 -> L07: { style.animated: true; style.stroke: "#9e9e9e" }
  L07 -> L08: { style.animated: true; style.stroke: "#9e9e9e" }
  L08 -> L09: { style.animated: true; style.stroke: "#9e9e9e" }
  L09 -> L10: { style.animated: true; style.stroke: "#9e9e9e" }
  L10 -> L11: { style.animated: true; style.stroke: "#9e9e9e" }
  L11 -> L12: { style.animated: true; style.stroke: "#9e9e9e" }
  L12 -> L13: { style.animated: true; style.stroke: "#9e9e9e" }
  L13 -> L14: { style.animated: true; style.stroke: "#9e9e9e" }
  L14 -> L15: { style.animated: true; style.stroke: "#9e9e9e" }
  L15 -> L16: { style.animated: true; style.stroke: "#9e9e9e" }
}

# Legend
legend: "Legend" {
  style: {
    fill: "#fafafa"
    stroke: "#bdbdbd"
    border-radius: 8
    shadow: true
    font-size: 13
  }
  input_leg: "Input / Sensor" {
    style: { fill: "#c8e6c9"; stroke: "#388e3c"; border-radius: 6; font-size: 13 }
  }
  proc_leg: "Processing / Core" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6; font-size: 13 }
  }
  meta_leg: "Meta / Self" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6; font-size: 13 }
  }
  safety_leg: "Safety / Guard" {
    style: { fill: "#ffcdd2"; stroke: "#e53935"; border-radius: 6; font-size: 13 }
  }
  tool_leg: "Tools / External" {
    style: { fill: "#ffe0b2"; stroke: "#ef6c00"; border-radius: 6; font-size: 13 }
  }
  affect_leg: "Affect / Emotion" {
    style: { fill: "#e1bee7"; stroke: "#8e24aa"; border-radius: 6; font-size: 13 }
  }
  infra_leg: "Infrastructure" {
    style: { fill: "#e0e0e0"; stroke: "#616161"; border-radius: 6; font-size: 13 }
  }
}
