title: |md
  # Cross-Phase Data Flow Architecture
| {
  near: top-center
  shape: text
  style.font-size: 24
}

L48: {
  label: "ðŸ“¦ L4.8 Architecture (13 modules)"
  style.border-radius: 8
  style.shadow: true
  style.fill: "#e1bee7"
  style.stroke: "#8e24aa"

  L48W: "WorldModel" {
    style.border-radius: 6
    style.fill: "#ce93d8"
    style.stroke: "#7b1fa2"
  }
  L48S: "SelfModel" {
    style.border-radius: 6
    style.fill: "#ce93d8"
    style.stroke: "#7b1fa2"
  }
  L48ST: "StrategyLayer" {
    style.border-radius: 6
    style.fill: "#ce93d8"
    style.stroke: "#7b1fa2"
  }
  L48SV: "StabilityVerifier" {
    style.border-radius: 6
    style.fill: "#ce93d8"
    style.stroke: "#7b1fa2"
  }
}

L49Phases: {
  label: "ðŸ“¦ L4.9 Phases (15 new modules)"
  style.border-radius: 8
  style.shadow: true
  style.fill: "#f3e5f5"
  style.stroke: "#7b1fa2"
  style.stroke-width: 2

  P1G: "Phase 1\nGoal Generation" {
    style.border-radius: 6
    style.fill: "#e1bee7"
    style.stroke: "#8e24aa"
  }
  P2V: "Phase 2\nValue Evolution" {
    style.border-radius: 6
    style.fill: "#e1bee7"
    style.stroke: "#8e24aa"
  }
  P3R: "Phase 3\nResource Survival" {
    style.border-radius: 6
    style.fill: "#e1bee7"
    style.stroke: "#8e24aa"
  }
  P4A: "Phase 4\nAgent Modeling" {
    style.border-radius: 6
    style.fill: "#e1bee7"
    style.stroke: "#8e24aa"
  }
  P5S: "Phase 5\nAutonomy Stability" {
    style.border-radius: 6
    style.fill: "#ffcdd2"
    style.stroke: "#c62828"
    style.stroke-width: 2
  }
}

OUTPUT: "ðŸ“Š FINAL OUTPUT" {
  style.border-radius: 6
  style.fill: "#c8e6c9"
  style.stroke: "#2e7d32"
}

L48.L48W -> L49Phases.P1G: "scenarios, EU, RES" {
  style.animated: true
}
L48.L48S -> L49Phases.P1G: "skill gaps, confidence" {
  style.animated: true
}
L48.L48SV -> L49Phases.P5S: "invariant results" {
  style.animated: true
}

L49Phases.P1G <-> L49Phases.P2V: "value alignment" {
  style.animated: true
}
L49Phases.P1G <-> L49Phases.P3R: "resource cost" {
  style.animated: true
}
L49Phases.P4A -> L49Phases.P1G: "agent opportunities" {
  style.animated: true
}
L49Phases.P3R -> L49Phases.P5S: "survival horizon" {
  style.animated: true
}
L49Phases.P2V -> L49Phases.P5S: "drift status" {
  style.animated: true
}

L49Phases.P5S -> L49Phases.P1G: "VETO" {
  style.stroke-dash: 5
  style.stroke: "#c62828"
}
L49Phases.P5S -> L49Phases.P2V: "VETO" {
  style.stroke-dash: 5
  style.stroke: "#c62828"
}
L49Phases.P5S -> L49Phases.P3R: "VETO" {
  style.stroke-dash: 5
  style.stroke: "#c62828"
}
L49Phases.P5S -> L49Phases.P4A: "VETO" {
  style.stroke-dash: 5
  style.stroke: "#c62828"
}

L49Phases.P5S -> OUTPUT: "L49CycleOutput" {
  style.animated: true
}
