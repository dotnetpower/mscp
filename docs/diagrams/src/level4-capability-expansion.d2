TRIGGER: "CGS > 0.7\n+ budget ok\n+ stable" {
  style: {
    fill: "#fff9c4"
    stroke: "#f9a825"
    border-radius: 8
    shadow: true
    stroke-width: 2
  }
}

Phase1: "Phase 1: ACQUISITION" {
  style: {
    fill: "#e3f2fd"
    stroke: "#1976d2"
    border-radius: 8
    shadow: true
  }

  P1: "Identify skill gap\nSearch for patterns\nBudget: max 10%" {
    style: {
      fill: "#bbdefb"
      stroke: "#1976d2"
      border-radius: 6
    }
  }

  P1OUT: "-> CapabilityHypothesis" {
    style: {
      fill: "#bbdefb"
      stroke: "#1976d2"
      border-radius: 6
    }
  }

  P1 -> P1OUT { style.animated: true }
}

Phase2: "Phase 2: EXPERIMENT" {
  style: {
    fill: "#e3f2fd"
    stroke: "#1976d2"
    border-radius: 8
    shadow: true
  }

  P2: "Design experiments\nMax 5 experiments\nBudget: max 20% each" {
    style: {
      fill: "#bbdefb"
      stroke: "#1976d2"
      border-radius: 6
    }
  }

  P2OUT: "-> ExperimentResults" {
    style: {
      fill: "#bbdefb"
      stroke: "#1976d2"
      border-radius: 6
    }
  }

  P2 -> P2OUT { style.animated: true }
}

Phase3: "Phase 3: EVALUATION" {
  style: {
    fill: "#fff3e0"
    stroke: "#ef6c00"
    border-radius: 8
    shadow: true
  }

  P3: "Analyze results\nCompute confidence\nCheck stability impact" {
    style: {
      fill: "#ffe0b2"
      stroke: "#ef6c00"
      border-radius: 6
    }
  }

  P3OUT: "-> EvaluationReport" {
    style: {
      fill: "#ffe0b2"
      stroke: "#ef6c00"
      border-radius: 6
    }
  }

  P3 -> P3OUT { style.animated: true }
}

Phase4: "Phase 4: ABSTRACTION" {
  style: {
    fill: "#e8f5e9"
    stroke: "#388e3c"
    border-radius: 8
    shadow: true
  }

  P4: "Extract general pattern\nCreate context signature\nRequires confidence > 0.6" {
    style: {
      fill: "#c8e6c9"
      stroke: "#388e3c"
      border-radius: 6
    }
  }

  P4OUT: "-> Candidate Skill" {
    style: {
      fill: "#c8e6c9"
      stroke: "#388e3c"
      border-radius: 6
    }
  }

  P4 -> P4OUT { style.animated: true }
}

Phase5: "Phase 5: VALIDATION" {
  style: {
    fill: "#ffcdd2"
    stroke: "#c62828"
    border-radius: 8
    shadow: true
  }

  P5: "Identity stability > 0.7?\nEthical check passed?\nC(t) not degraded?" {
    shape: diamond
    style: {
      fill: "#ffebee"
      stroke: "#e53935"
      border-radius: 6
    }
  }
}

COMMIT: "COMMIT\nSkill added" {
  style: {
    fill: "#c8e6c9"
    stroke: "#2e7d32"
    border-radius: 8
    shadow: true
    stroke-width: 2
  }
}

DISCARD: "DISCARD\nInsufficient evidence" {
  style: {
    fill: "#ef9a9a"
    stroke: "#b71c1c"
    border-radius: 8
    shadow: true
  }
}

TRIGGER -> Phase1: {
  style.animated: true
}

Phase1 -> Phase2: {
  style.animated: true
}

Phase2 -> Phase3: {
  style.animated: true
}

Phase3 -> Phase4: {
  style.animated: true
}

Phase4 -> Phase5: {
  style.animated: true
}

Phase5.P5 -> COMMIT: "pass" {
  style.animated: true
  style.stroke: "#2e7d32"
}

Phase5.P5 -> DISCARD: "fail" {
  style.animated: true
  style.stroke: "#b71c1c"
}
