shape: sequence_diagram

U: "ðŸ‘¤ User" {
  style: {
    fill: "#e8f5e9"
    stroke: "#4caf50"
  }
}
IR: "Intent Router" {
  style: {
    fill: "#e3f2fd"
    stroke: "#2196f3"
  }
}
TV: "Tool Validator" {
  style: {
    fill: "#e3f2fd"
    stroke: "#2196f3"
  }
}
TD: "Tool Dispatcher" {
  style: {
    fill: "#fff3e0"
    stroke: "#ff9800"
  }
}
T: "External Tool" {
  style: {
    fill: "#fff3e0"
    stroke: "#ff9800"
  }
}
RG: "Response Generator" {
  style: {
    fill: "#ede7f6"
    stroke: "#673ab7"
  }
}
LLM: "LLM Backend" {
  style: {
    fill: "#ede7f6"
    stroke: "#673ab7"
  }
}

U -> IR: "What's the weather in Seoul?"
IR -> IR: "classify(input)\nconfidence = 0.85\nsuggested_tool = search"
IR -> TV: "IntentResult{tool_call, [search], params}"
TV -> TV: "validate(params, tool_schema)"
TV -> TD: 'ValidatedAction{tool="search", query="Seoul weather"}'
TD -> T: 'execute(query="Seoul weather")'
T -> TD: 'ToolResult{success=true, data="Sunny, 15Â°C"}'
TD -> RG: "ToolResult"
RG -> LLM: "format_response(tool_result, user_query)"
LLM -> RG: "The weather in Seoul is sunny\nwith a temperature of 15Â°C."
RG -> U: "Final Response"
