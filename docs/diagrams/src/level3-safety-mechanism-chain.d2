direction: right

S1: "ðŸ”’ Structural Safety" {
  style: {
    fill: "#c8e6c9"
    stroke: "#2e7d32"
    border-radius: 8
    shadow: true
    bold: true
    font-size: 13
  }
  A: "Identity hash\nper cycle" {
    style: { fill: "#a5d6a7"; stroke: "#2e7d32"; border-radius: 6 }
  }
  B: "Delta clamping\n(max 0.05)" {
    style: { fill: "#a5d6a7"; stroke: "#2e7d32"; border-radius: 6 }
  }
  C: "Immutable\nidentity_id" {
    style: { fill: "#a5d6a7"; stroke: "#2e7d32"; border-radius: 6 }
  }
}

S2: "ðŸ›¡ï¸ Process Safety" {
  style: {
    fill: "#fff9c4"
    stroke: "#f9a825"
    border-radius: 8
    shadow: true
    bold: true
    font-size: 13
  }
  D: "Prediction-gated\nactions" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6 }
  }
  E: "Max 3 updates\nper cycle" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6 }
  }
  F: "Cooldown after\nescalation" {
    style: { fill: "#fff59d"; stroke: "#f9a825"; border-radius: 6 }
  }
}

S3: "âš–ï¸ Ethical Safety" {
  style: {
    fill: "#ffcdd2"
    stroke: "#c62828"
    border-radius: 8
    shadow: true
    bold: true
    font-size: 13
  }
  G: "Layer 0:\nimmutable rules" {
    style: { fill: "#ef9a9a"; stroke: "#e53935"; border-radius: 6 }
  }
  H: "Layer 1:\nadaptive policy" {
    style: { fill: "#ef9a9a"; stroke: "#e53935"; border-radius: 6 }
  }
  I: "Value lock:\nhash integrity" {
    style: { fill: "#ef9a9a"; stroke: "#e53935"; border-radius: 6 }
  }
}

S4: "ðŸ“‰ Convergence Safety" {
  style: {
    fill: "#e3f2fd"
    stroke: "#1976d2"
    border-radius: 8
    shadow: true
    bold: true
    font-size: 13
  }
  J: "Lyapunov\nfunction C(t)" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6 }
  }
  K: "Oscillation\ndetection" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6 }
  }
  L: "Graceful\ndegradation" {
    style: { fill: "#bbdefb"; stroke: "#1976d2"; border-radius: 6 }
  }
}

S5: "ðŸ  Existential Safety (v4)" {
  style: {
    fill: "#e1bee7"
    stroke: "#8e24aa"
    border-radius: 8
    shadow: true
    bold: true
    font-size: 13
  }
  M: "Homeostatic\nmonitoring" {
    style: { fill: "#ce93d8"; stroke: "#8e24aa"; border-radius: 6 }
  }
  N: "Survival goal\ncap (0.85)" {
    style: { fill: "#ce93d8"; stroke: "#8e24aa"; border-radius: 6 }
  }
  O: "Goal TTL\n(auto-expire)" {
    style: { fill: "#ce93d8"; stroke: "#8e24aa"; border-radius: 6 }
  }
}

S1 -> S2: {
  style.animated: true
  style.stroke: "#f9a825"
  style.stroke-width: 3
}
S2 -> S3: {
  style.animated: true
  style.stroke: "#c62828"
  style.stroke-width: 3
}
S3 -> S4: {
  style.animated: true
  style.stroke: "#1976d2"
  style.stroke-width: 3
}
S4 -> S5: {
  style.animated: true
  style.stroke: "#8e24aa"
  style.stroke-width: 3
}
